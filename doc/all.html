<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="by 18089" />


<title>Introduction to StatComp18089</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp18089</h1>
<h4 class="author"><em>by 18089</em></h4>
<h4 class="date"><em>2019.1.11</em></h4>



<div id="section" class="section level1">
<h1>1</h1>
</div>
<div id="exercises-3.5" class="section level1">
<h1>exercises 3.5</h1>
<p>A discrete random variable X has probability mass function x 0 1 2 3 4 ———————— p(x) 0.1 0.2 0.2 0.2 0.3</p>
<p>Use the inverse transform method to generate a random sample of size 1000 from the distribution of X.Construct a relative frequency table and compare the empirical with the theoretical probabilities.Repeat using the R sample function.</p>
</div>
<div id="answer" class="section level1">
<h1>answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inv_F&lt;-<span class="cf">function</span>(x){
  <span class="cf">if</span>(x<span class="op">&lt;=</span><span class="fl">0.1</span>)
    F&lt;-<span class="dv">0</span>
  <span class="cf">else</span> <span class="cf">if</span>(x<span class="op">&lt;=</span><span class="fl">0.3</span>)
    F&lt;-<span class="dv">1</span>
  <span class="cf">else</span> <span class="cf">if</span>(x<span class="op">&lt;=</span><span class="fl">0.5</span>)
    F&lt;-<span class="dv">2</span>
  <span class="cf">else</span> <span class="cf">if</span>(x<span class="op">&lt;=</span><span class="fl">0.7</span>)
    F&lt;-<span class="dv">3</span>
  <span class="cf">else</span> <span class="cf">if</span>(x<span class="op">&lt;=</span><span class="dv">1</span>)
    F&lt;-<span class="dv">4</span>
  <span class="kw">return</span>(F)
} <span class="co">#Use the inverse transform method</span>
x&lt;-<span class="kw">runif</span>(<span class="dv">1000</span>) <span class="co">#generate a uniform distribution sample</span>
sam&lt;-<span class="kw">sapply</span>(x, inv_F)
p0&lt;-<span class="kw">length</span>(<span class="kw">which</span>(sam<span class="op">==</span><span class="dv">0</span>))<span class="op">/</span><span class="dv">1000</span>
p1&lt;-<span class="kw">length</span>(<span class="kw">which</span>(sam<span class="op">==</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">1000</span>
p2&lt;-<span class="kw">length</span>(<span class="kw">which</span>(sam<span class="op">==</span><span class="dv">2</span>))<span class="op">/</span><span class="dv">1000</span>
p3&lt;-<span class="kw">length</span>(<span class="kw">which</span>(sam<span class="op">==</span><span class="dv">3</span>))<span class="op">/</span><span class="dv">1000</span>
p4&lt;-<span class="kw">length</span>(<span class="kw">which</span>(sam<span class="op">==</span><span class="dv">4</span>))<span class="op">/</span><span class="dv">1000</span> <span class="co">#get the empirical probabilities</span>
## relative frequency table
<span class="kw">table</span>(sam)</code></pre></div>
<pre><code>## sam
##   0   1   2   3   4 
## 109 226 184 188 293</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## the empirical probabilities
p0</code></pre></div>
<pre><code>## [1] 0.109</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p1</code></pre></div>
<pre><code>## [1] 0.226</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2</code></pre></div>
<pre><code>## [1] 0.184</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p3</code></pre></div>
<pre><code>## [1] 0.188</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p4</code></pre></div>
<pre><code>## [1] 0.293</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## the empirical probabilities are close to the corresponding theoretical probabilities
## Repeat using the R sample function
x&lt;-<span class="kw">runif</span>(<span class="dv">1000</span>) <span class="co">#generate a uniform distribution sample</span>
sam&lt;-<span class="kw">sapply</span>(x, inv_F)
p0&lt;-<span class="kw">length</span>(<span class="kw">which</span>(sam<span class="op">==</span><span class="dv">0</span>))<span class="op">/</span><span class="dv">1000</span>
p1&lt;-<span class="kw">length</span>(<span class="kw">which</span>(sam<span class="op">==</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">1000</span>
p2&lt;-<span class="kw">length</span>(<span class="kw">which</span>(sam<span class="op">==</span><span class="dv">2</span>))<span class="op">/</span><span class="dv">1000</span>
p3&lt;-<span class="kw">length</span>(<span class="kw">which</span>(sam<span class="op">==</span><span class="dv">3</span>))<span class="op">/</span><span class="dv">1000</span>
p4&lt;-<span class="kw">length</span>(<span class="kw">which</span>(sam<span class="op">==</span><span class="dv">4</span>))<span class="op">/</span><span class="dv">1000</span> <span class="co">#get the empirical probabilities</span>
## relative frequency table
<span class="kw">table</span>(sam)</code></pre></div>
<pre><code>## sam
##   0   1   2   3   4 
## 103 188 190 192 327</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## the empirical probabilities
p0</code></pre></div>
<pre><code>## [1] 0.103</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p1</code></pre></div>
<pre><code>## [1] 0.188</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2</code></pre></div>
<pre><code>## [1] 0.19</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p3</code></pre></div>
<pre><code>## [1] 0.192</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p4</code></pre></div>
<pre><code>## [1] 0.327</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## the empirical probabilities are close to the corresponding theoretical probabilities</code></pre></div>
</div>
<div id="exercise-3.7" class="section level1">
<h1>exercise 3.7</h1>
<p>Write a function to generate a random sample of size n from the Beta(a,b) distribution by the acceptance-rejection method.Generate a random sample of size 1000 from the Beta(3,2) distribution.Graph the histogram of the sample with the theoretical Beta(3,2) density superimposed.</p>
</div>
<div id="answer-1" class="section level1">
<h1>answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fun1&lt;-<span class="cf">function</span>(n,a,b){
j&lt;-k&lt;-<span class="dv">0</span>;
y &lt;-<span class="st"> </span><span class="kw">numeric</span>(n) 
<span class="cf">while</span> (k <span class="op">&lt;</span><span class="st"> </span>n)
  { u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) 
  j &lt;-<span class="st"> </span>j <span class="op">+</span><span class="st"> </span><span class="dv">1</span> 
  x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g </span>
  <span class="cf">if</span> (x<span class="op">^</span>(a<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span>(b<span class="op">-</span><span class="dv">1</span>) <span class="op">&gt;</span><span class="st"> </span>u)
    { 
    <span class="co">#we accept x </span>
    k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span> 
    y[k] &lt;-<span class="st"> </span>x 
    }
 } 
j
}<span class="co">#a function to generate a random sample</span>
<span class="kw">fun1</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 11686</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#the Beta(3,2)</span>
n&lt;-<span class="dv">1000</span>
j&lt;-k&lt;-<span class="dv">0</span>
y &lt;-<span class="st"> </span><span class="kw">numeric</span>(n) 
<span class="cf">while</span> (k <span class="op">&lt;</span><span class="st"> </span>n)
  { u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) 
  j &lt;-<span class="st"> </span>j <span class="op">+</span><span class="st"> </span><span class="dv">1</span> 
  x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g </span>
  <span class="cf">if</span> (x<span class="op">*</span>x<span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>x) <span class="op">&gt;</span><span class="st"> </span>u)
    { 
    <span class="co">#we accept x </span>
    k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span> 
    y[k] &lt;-<span class="st"> </span>x 
    }
 } 
j</code></pre></div>
<pre><code>## [1] 11519</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(y,<span class="dt">prob =</span> <span class="ot">TRUE</span>)<span class="co">#histogram of the sample</span>
z &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>) 
<span class="kw">lines</span>(z, <span class="dv">12</span><span class="op">*</span>z<span class="op">*</span>z<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>z))<span class="co">#the theoretical Beta(3,2) density superimposed</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.12" class="section level1">
<h1>exercise 3.12</h1>
<p>Simulate a continuous Exponential-Gamma mixture.Suppose that the rate parameter ?? has Gamma(r,??) distribution and Y has Exp(??) distribution.That is,(Y|??=??)~fY(y|??)=??e^(-??y).Generate 1000 random observations from this mixture with r=4 and ??=2.</p>
</div>
<div id="answer-2" class="section level1">
<h1>answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">1000</span>
r &lt;-<span class="st"> </span><span class="dv">4</span>
beta &lt;-<span class="st"> </span><span class="dv">2</span>
lambda &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n, r, beta) <span class="co">#Gamma(r,??) distribution</span>
x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, lambda)<span class="co">#Exp(??) distribution</span>
x</code></pre></div>
<pre><code>##    [1] 8.920588e-01 1.477193e+00 3.908501e-01 2.054378e-01 7.506783e-01
##    [6] 1.401447e-01 2.514201e-02 6.602432e-02 6.526992e-01 3.854119e-01
##   [11] 2.672898e-02 1.475757e-01 6.235330e-01 1.594150e-01 3.744210e-01
##   [16] 3.216717e+00 1.199351e-01 1.976779e-02 1.322221e-01 2.686728e-01
##   [21] 2.123819e-01 1.415151e+00 1.550098e+01 4.553068e-01 1.559981e-01
##   [26] 8.840520e-02 6.013161e-02 1.976617e+00 2.647957e-01 2.260835e-01
##   [31] 3.216598e-02 1.012555e-01 1.547823e-01 1.754586e-01 1.052135e+00
##   [36] 9.491196e-01 2.404952e-01 1.155445e+00 1.078710e-01 6.798221e-03
##   [41] 4.056199e-01 3.043261e-01 1.954546e+00 4.137483e-01 2.658814e-02
##   [46] 2.453327e-01 8.938755e+00 2.144640e-01 7.308480e-02 5.464569e-01
##   [51] 1.612569e+00 2.055233e-01 1.355461e-01 4.175134e-01 2.036700e-01
##   [56] 7.238370e-01 4.713570e-01 2.747195e+00 5.987529e-02 1.963153e+00
##   [61] 3.093777e-01 5.256531e-01 3.939432e-01 3.016528e-01 2.016760e-01
##   [66] 6.301879e-01 1.661781e+00 1.087685e+00 2.136024e-01 7.014971e-01
##   [71] 3.620818e-01 1.979246e-01 1.163799e+00 6.714997e-03 5.466827e-01
##   [76] 5.391093e-01 9.522164e-01 2.703255e-01 2.194392e-01 1.347361e+00
##   [81] 1.489835e-01 1.416781e+00 7.939214e-01 4.368595e-01 4.234920e-01
##   [86] 1.162854e-01 2.625514e-01 3.685950e-01 2.013153e-01 1.192104e+00
##   [91] 5.690120e-02 6.678344e-01 6.625319e-01 1.201412e-01 9.238667e-02
##   [96] 5.217945e-01 5.914076e-01 3.924404e-01 4.146801e-01 4.046751e-01
##  [101] 8.926660e-01 2.857041e-01 1.231895e+00 2.817622e-01 4.814130e-01
##  [106] 2.143251e-01 1.375750e+00 1.692844e-02 1.048215e+00 6.486127e-01
##  [111] 6.380450e-02 8.640305e-01 3.666597e-01 2.439776e-02 3.875217e-01
##  [116] 3.076013e-01 1.929652e-01 1.058694e-02 2.677733e-01 4.040046e-01
##  [121] 1.171166e-01 1.320133e+00 3.459219e-01 1.948896e-02 2.487670e-01
##  [126] 7.810658e-02 7.929259e-01 2.727965e-01 9.726210e-01 1.947511e-01
##  [131] 5.783602e-01 5.090374e-02 4.900714e-01 3.029377e-01 6.768618e-01
##  [136] 2.658367e-01 1.566317e+00 2.495965e-01 6.421766e-01 1.415388e-01
##  [141] 6.595188e-01 3.390789e-01 2.075409e-01 2.829150e+00 1.236206e+00
##  [146] 4.483165e-01 4.324195e-01 2.092858e-01 7.105760e-02 1.879085e-01
##  [151] 5.179431e-01 1.912348e-01 3.950399e-03 4.750812e-02 3.626594e-02
##  [156] 8.638623e-02 5.704209e-01 5.573495e-01 5.923379e-02 4.552087e-01
##  [161] 2.831092e-02 2.049817e-01 1.301084e-01 3.643892e-01 4.957173e-02
##  [166] 2.831179e-01 3.236981e-01 2.815078e-01 1.560666e-01 1.430833e-01
##  [171] 1.191488e+00 3.812011e+00 5.435984e-01 7.484571e-02 5.530213e-02
##  [176] 7.685444e+00 5.189106e-01 2.522834e-01 6.456795e-01 2.554631e-01
##  [181] 5.847256e-01 3.815351e-01 8.539170e-01 1.883397e+00 1.453540e-01
##  [186] 9.331605e-01 1.269343e+00 1.622116e+00 1.099013e-01 3.363731e-01
##  [191] 1.761612e+00 1.585025e+00 2.057159e-01 7.434984e-02 3.701151e-01
##  [196] 6.345677e-01 1.292649e+00 2.646807e-01 2.677221e-01 2.937261e-01
##  [201] 1.222288e-01 6.611644e-01 1.121092e+00 1.547852e-01 4.309122e-01
##  [206] 6.758687e-02 1.364389e-01 2.486954e+00 1.369406e+00 1.104900e+00
##  [211] 1.253424e-01 6.404615e-01 7.450098e-01 3.874412e-01 3.959097e-01
##  [216] 8.185246e-01 4.830182e-01 1.127817e-01 3.863693e-01 4.941243e-01
##  [221] 2.176309e+00 6.003750e-01 8.017043e-01 2.015640e-01 5.567550e-02
##  [226] 7.997921e-02 1.350169e+00 2.405766e+00 1.051334e-01 7.614895e-02
##  [231] 2.534265e-01 8.020940e+00 1.824006e-01 3.068136e-01 1.204677e-01
##  [236] 1.136235e-01 1.171799e-01 5.457608e-01 1.417879e-02 5.697079e-01
##  [241] 1.169087e-01 1.240088e+00 2.710885e-01 1.955859e-01 1.139925e-01
##  [246] 4.781639e-01 4.960840e-01 5.651487e-01 9.510164e-01 4.841355e-01
##  [251] 3.208157e-01 2.375787e-01 3.392960e-01 2.323862e-01 2.828647e-02
##  [256] 1.421184e-01 6.563210e-01 1.016638e+00 1.868408e+00 3.334608e-01
##  [261] 4.625229e-02 4.607589e-01 2.009348e-01 9.016276e-01 1.843927e-01
##  [266] 1.288737e-01 1.025300e+00 9.523789e-02 1.650702e+00 3.744866e-01
##  [271] 3.879854e-02 4.880946e-01 5.191995e-01 1.891265e+00 5.302677e-02
##  [276] 1.013367e+00 2.591411e+00 1.307383e+00 8.795578e-02 9.259870e-03
##  [281] 5.454778e-01 1.347926e-01 1.985977e-01 1.723885e-02 8.844912e-01
##  [286] 1.637754e-01 4.183925e-01 1.986989e-01 1.394919e-01 1.936104e-01
##  [291] 1.016334e+00 2.066172e-01 4.238320e-01 2.645430e-01 1.991340e-02
##  [296] 8.389378e-01 9.143679e-01 6.573368e-01 7.140757e-01 6.552514e-02
##  [301] 5.026859e-02 1.422924e+00 5.765041e-02 3.302344e-01 5.428984e-02
##  [306] 9.798356e-02 2.285003e-01 5.583558e-01 3.780594e-03 1.742753e+00
##  [311] 7.418839e-01 4.976272e-01 1.430246e-01 2.370563e-01 7.108537e-01
##  [316] 5.168003e-01 5.539062e-02 8.035836e-01 8.588828e-02 1.156214e+00
##  [321] 2.823431e-01 2.226678e-01 1.084463e+00 9.945095e-01 6.742165e-02
##  [326] 1.243916e-02 1.031221e-02 8.964783e-01 2.879817e-01 9.590581e-01
##  [331] 8.383154e-01 1.923335e+00 1.203108e+00 3.359134e+00 7.943887e-01
##  [336] 2.869345e-01 1.753296e+00 1.065511e-01 4.806729e-01 1.646585e-01
##  [341] 1.130901e+00 2.264660e-01 1.352848e-01 6.468345e-02 4.198580e-01
##  [346] 2.173593e-01 6.757051e-01 1.690346e+00 1.954216e-01 3.680132e-02
##  [351] 7.880626e-01 6.924067e-03 2.804621e-01 1.303765e-01 1.211433e-01
##  [356] 5.132365e-02 1.556051e-01 7.477167e-02 1.662574e-01 2.200768e+00
##  [361] 4.543278e-01 4.281079e-02 4.094440e-01 6.046879e-02 9.693951e-02
##  [366] 2.909086e-01 2.965240e-03 6.524256e-01 1.365096e-01 8.864497e-02
##  [371] 1.716081e-01 8.986589e-01 1.289246e+00 4.399335e-01 9.798799e-01
##  [376] 2.977947e-01 1.634938e-01 3.607841e-02 2.100313e-01 2.967412e-01
##  [381] 2.511266e-01 1.010679e+00 6.928679e-02 1.150791e-01 6.580660e-01
##  [386] 8.226020e-03 5.283470e-02 8.568918e-02 2.839074e-01 9.318507e-01
##  [391] 2.684267e-03 9.618255e-02 6.525100e-01 1.896291e+00 8.220933e-01
##  [396] 1.789493e-02 2.128798e-01 4.790402e-01 3.259759e-02 3.225929e-02
##  [401] 1.337507e-01 6.200860e-01 2.300285e-01 1.757899e+00 1.312734e+00
##  [406] 6.354528e-01 1.589687e+00 2.529395e+00 7.842030e-01 2.092750e-01
##  [411] 3.036079e-01 3.987207e-01 1.924647e-01 7.926264e-01 6.386539e-02
##  [416] 1.792920e-02 4.168417e-01 2.118953e-01 3.146991e-01 1.749074e-01
##  [421] 2.222028e-02 8.884861e-01 2.221346e+00 8.995731e-01 2.742121e-01
##  [426] 1.545084e-01 1.000174e-03 5.326028e-01 1.744476e-01 2.687965e-01
##  [431] 7.596263e-01 3.737771e-02 2.590754e-01 2.521627e-01 5.683820e-01
##  [436] 4.607703e-01 5.225304e-01 7.511122e-02 4.107181e-01 4.179164e-01
##  [441] 1.104361e+00 6.678539e-03 1.268930e+00 1.380511e-02 4.944092e-02
##  [446] 4.684716e-01 1.100222e+00 1.168302e+00 2.572458e+00 4.027257e-01
##  [451] 5.219950e-02 1.709179e+00 1.511391e-01 3.695256e-01 6.835087e-01
##  [456] 1.511470e-02 5.662546e-01 5.446450e-01 6.435407e-01 1.014101e+00
##  [461] 1.368524e-01 9.018524e-01 6.305130e-01 7.382924e-01 1.537386e+00
##  [466] 1.171156e-01 3.922740e-02 1.842632e-01 2.713114e-02 3.181109e-01
##  [471] 1.816698e-01 2.200467e-01 4.353214e-01 1.256948e-01 7.647065e-01
##  [476] 5.496253e-01 9.938818e-02 1.217746e+00 2.069305e-01 3.189367e-02
##  [481] 3.905664e-01 3.599714e-01 2.038299e-01 2.207467e-01 2.098035e-01
##  [486] 1.340106e+00 2.838136e-01 1.992979e-01 1.719424e+00 3.393615e-01
##  [491] 1.270024e-01 5.484635e-01 1.165855e+00 5.030892e-01 6.130936e-01
##  [496] 1.849704e-01 2.516578e-01 3.255050e-02 3.915655e-01 6.995110e-01
##  [501] 6.467390e+00 5.060330e-01 4.530401e-01 6.461837e-02 6.258229e-01
##  [506] 2.481859e-01 1.475641e+00 2.916955e-01 1.477184e-01 2.042416e-02
##  [511] 1.668400e+00 1.380431e-03 2.035438e-02 2.061264e-01 1.825197e+00
##  [516] 1.442091e-01 2.172204e+00 4.086727e-01 1.622800e-01 4.196144e-02
##  [521] 6.001213e-01 3.526731e-01 1.297164e-01 1.180085e+00 4.527455e-01
##  [526] 9.570293e-01 9.133235e-02 2.730778e-01 1.203853e+00 3.147947e-02
##  [531] 4.691478e-01 3.927224e-01 2.028501e+00 5.459144e-01 3.626885e+00
##  [536] 1.584574e-01 9.306182e-02 1.326048e+00 1.973685e+00 7.314712e-01
##  [541] 6.591557e-02 3.218669e-01 7.799649e-01 1.943245e-01 5.155707e-01
##  [546] 4.124260e-01 8.925415e-01 2.119384e-01 3.365315e+00 5.433131e-01
##  [551] 1.204381e+00 5.011826e-02 9.485900e-02 4.431287e-01 2.783180e-01
##  [556] 2.512121e+00 5.865437e-01 2.298030e-01 6.341220e-01 1.105784e+00
##  [561] 1.123559e-02 4.034297e-01 9.156065e-01 4.926894e-01 6.794571e-01
##  [566] 1.703055e-01 1.956450e-01 5.725490e-01 7.009694e-01 1.003269e+00
##  [571] 1.025390e+00 8.716672e-02 7.714072e-01 6.858783e-01 5.702666e-01
##  [576] 5.276759e-01 1.886212e+00 2.515436e-01 3.156728e-01 4.539998e-01
##  [581] 1.336258e+00 5.684879e-01 3.327134e-01 2.479142e-01 8.227402e-01
##  [586] 1.280088e-01 2.656936e-01 9.020641e-01 1.347163e-01 8.491254e-02
##  [591] 3.687865e+00 3.803992e-01 1.258230e+00 3.108845e-01 3.222468e-01
##  [596] 7.993998e-01 3.340764e+00 4.069618e-01 2.154389e+00 6.804191e-02
##  [601] 5.777508e-02 6.633098e-01 7.327264e-01 5.228757e-01 3.161133e-01
##  [606] 1.334678e-01 6.349040e-01 2.416215e-01 1.041562e+00 8.446833e-02
##  [611] 2.458894e-02 3.094595e-01 8.236350e-01 6.857423e-01 4.352624e-01
##  [616] 8.217449e-03 9.682978e-01 1.843960e-01 3.472734e-01 1.206270e+00
##  [621] 1.601784e+00 5.510016e-01 9.543212e-01 8.823422e-02 1.120121e-02
##  [626] 1.104890e+00 1.017057e+00 1.622436e+00 6.921780e-01 3.718101e-01
##  [631] 2.858537e-01 7.702474e-01 1.753792e-01 7.832580e-02 1.517062e-01
##  [636] 2.512675e-01 1.424102e-01 2.733306e-01 8.778586e-01 1.441530e+00
##  [641] 2.409455e-01 4.638098e-01 3.240168e-02 1.146184e-02 3.492115e-01
##  [646] 4.743393e-01 3.122871e-01 1.034973e+00 5.205759e-01 5.351896e-01
##  [651] 1.157532e+00 2.447193e-01 1.971754e-01 2.295269e-01 9.015394e-01
##  [656] 2.453832e-01 2.226526e-01 3.648065e-01 4.316851e-03 1.262697e-01
##  [661] 5.813375e-01 7.841241e-01 6.333850e-02 5.329348e-01 8.601449e-02
##  [666] 1.027179e+00 2.855827e-01 9.787922e-01 6.096266e-01 2.189044e-01
##  [671] 8.673471e-01 4.062508e-01 5.151463e-01 1.508698e+00 3.308741e-01
##  [676] 6.352286e-02 1.834882e-01 2.764367e-01 4.101860e-01 2.116523e+00
##  [681] 6.974961e-02 1.057728e+00 3.537553e-01 2.249302e-01 2.618102e+00
##  [686] 4.157154e-01 9.814596e-01 1.566647e+00 9.142453e-01 2.026833e-01
##  [691] 2.461598e-01 3.355305e-01 1.543197e+00 7.486760e-02 6.347149e+00
##  [696] 7.807495e-01 3.479201e-02 1.147978e-01 4.939498e+00 1.630369e+00
##  [701] 6.685611e-01 6.626638e-01 9.225311e-01 1.148047e-01 6.720199e-01
##  [706] 8.803246e-01 3.309824e-01 3.544482e-01 2.889812e-01 2.155805e-01
##  [711] 2.905108e-01 1.569323e-01 6.554029e-01 1.807976e+00 3.380793e-01
##  [716] 5.337888e-01 4.647231e-02 2.435735e-01 1.172072e-01 5.833204e-01
##  [721] 3.598869e+00 6.034781e-01 2.409858e-01 8.411057e-02 6.065275e-02
##  [726] 2.749101e-02 2.359658e-01 4.830324e-01 5.601451e-01 2.369098e-01
##  [731] 1.895686e-01 2.201340e+00 6.269969e-01 1.323108e+00 9.559710e-01
##  [736] 6.917352e-01 1.362847e+00 1.693675e+00 1.367278e-01 2.568423e-01
##  [741] 4.699930e-01 1.253222e+00 4.181695e-01 1.167963e-01 1.422387e-01
##  [746] 4.245740e-01 1.580204e+00 1.657131e-02 1.122315e-02 3.743119e-01
##  [751] 1.436921e-01 4.835312e-01 7.245129e-01 1.148118e+00 3.316144e-01
##  [756] 2.276087e-01 6.670769e-02 8.828992e-02 3.193867e-01 5.886967e-01
##  [761] 6.528769e-01 1.336338e-01 4.637095e-01 1.551109e-01 6.841843e-02
##  [766] 1.549516e+00 2.153603e-02 3.353736e+00 2.012561e-01 1.990771e-01
##  [771] 2.359000e+00 5.051541e-01 2.393370e+00 4.870878e-01 5.735824e-01
##  [776] 5.812281e-01 2.684680e-01 1.762505e-01 2.470239e+00 3.773562e-01
##  [781] 8.329505e-01 1.331729e-01 8.535541e-01 2.456106e-01 2.129062e-01
##  [786] 5.510413e-01 3.115118e-01 4.900844e-01 9.704053e-01 1.175868e-01
##  [791] 3.208818e-02 3.169891e-01 2.973351e-01 3.087750e-01 6.475796e-02
##  [796] 1.376584e-01 2.055946e-01 4.281225e-01 3.672101e-01 4.644305e-01
##  [801] 1.769566e+00 1.360203e+00 5.300031e-01 1.233021e+00 4.229377e-01
##  [806] 3.463776e-01 5.870059e-01 1.792799e+00 2.031060e-01 7.723808e-01
##  [811] 5.500517e-01 1.266845e-01 3.516849e-03 4.299828e-01 6.170204e-01
##  [816] 1.690464e-02 6.185673e-01 8.254142e-02 3.589250e-05 1.623083e-02
##  [821] 5.818082e-01 9.068553e-01 5.425652e-01 1.177913e-01 2.108814e-01
##  [826] 6.945171e-02 7.456000e-01 8.950019e-01 2.244940e-02 4.348508e-01
##  [831] 1.717477e-02 1.857396e-01 3.695319e-01 3.383658e-01 5.388131e-01
##  [836] 3.629855e-01 1.049467e-01 2.805364e-02 3.901602e-01 2.059714e-01
##  [841] 1.554237e-01 1.595944e-01 1.931643e-01 6.933876e-01 3.931240e-02
##  [846] 1.865180e-01 1.505779e-01 5.234149e-02 9.312875e-01 1.755200e-01
##  [851] 1.635497e-02 7.772846e-01 5.091026e-01 5.369482e-02 2.967487e+00
##  [856] 1.140747e+00 1.327947e+00 8.136473e-01 5.982029e-01 1.073371e-01
##  [861] 3.813343e-01 1.163806e+00 1.467501e-01 9.797213e-03 8.207716e-01
##  [866] 4.187713e-01 6.826632e-01 3.067840e-01 1.523198e-01 8.136670e-01
##  [871] 6.873425e-01 1.297457e-01 6.102321e-01 8.102372e-02 1.008568e+00
##  [876] 1.224785e-01 4.739147e+00 3.868697e-01 1.309164e-02 6.539600e-02
##  [881] 1.080974e-01 5.598445e+00 3.505744e-01 8.232695e-02 2.994356e-01
##  [886] 6.493286e-01 2.705170e-01 1.135357e-01 4.412032e-01 5.032137e-01
##  [891] 5.064661e-02 2.731571e+00 7.069236e-01 3.642978e-01 1.051011e+00
##  [896] 5.287153e-02 8.694429e-02 1.039061e+00 3.567339e+00 2.264796e-01
##  [901] 7.473440e-01 3.313801e-01 2.259322e+00 3.360473e+00 1.208590e+00
##  [906] 2.417072e-01 3.252185e-01 4.815253e-01 1.878645e+00 1.167858e+00
##  [911] 4.659607e-01 2.476414e-01 3.814333e-01 7.436787e-01 1.477930e-01
##  [916] 6.326584e-02 2.613745e-01 1.840019e-01 2.324796e-02 3.081523e-01
##  [921] 9.961642e-02 3.911261e-03 1.463802e-01 3.037671e-01 2.037111e-01
##  [926] 1.047738e-01 1.005790e-01 6.640057e-02 1.259802e-01 8.509868e-02
##  [931] 2.817344e-02 1.658087e+00 2.764017e-04 9.734605e-01 3.887475e-01
##  [936] 1.024400e-01 9.645763e-01 4.541099e-01 1.990877e-01 1.966713e-01
##  [941] 1.563020e+00 1.089804e-01 3.694049e-01 2.607958e-01 2.646807e-01
##  [946] 3.274917e-02 2.869674e-01 6.068244e-01 2.523278e+00 1.148018e+00
##  [951] 6.827748e-02 3.595977e-02 2.397825e-01 1.470368e+00 9.644474e-02
##  [956] 1.295705e+00 1.497361e+00 1.033936e+00 3.722896e-01 6.472381e-01
##  [961] 6.662921e-02 9.673045e-02 5.536495e-03 4.998383e-01 2.824751e-01
##  [966] 1.209929e-01 1.798623e-01 1.006397e-01 2.071748e-01 1.036760e-01
##  [971] 1.451322e-01 2.908375e-01 3.035076e-02 1.501074e+00 4.923403e-01
##  [976] 4.101095e+00 1.934619e-01 2.580793e-01 3.540997e-01 4.397149e-01
##  [981] 4.338630e-01 8.652988e-01 2.953365e-01 2.519400e-01 5.264022e-01
##  [986] 3.708949e-01 1.369576e+00 1.097552e+00 2.358451e-01 7.812436e-01
##  [991] 5.856335e-01 3.664071e-01 2.113406e-01 2.426876e-02 5.310657e-01
##  [996] 3.592558e-01 9.152130e-01 1.222442e+00 3.657598e-01 6.079849e-02</code></pre>
</div>
<div id="section-1" class="section level1">
<h1>2</h1>
</div>
<div id="question" class="section level1">
<h1>question</h1>
<div id="exercise-5.4" class="section level3">
<h3>exercise 5.4</h3>
<p>Write a function to compute a Monto Carlo estimate of the Beta(3,3) cdf,and use the function to estimate F(x) for x=0.1,0.2,…,0.9.Compare the estimates with the values returned by the pbeta function in R.</p>
</div>
</div>
<div id="answer-3" class="section level1">
<h1>answer</h1>
<p>First,we can write the Beta(3,3) cdf. <span class="math display">\[\int_{0}^{x}30t^2(1-t)^2 dt\]</span> So,we get the Monto Carlo estimate is :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MCF&lt;-<span class="cf">function</span>(a){
  m&lt;-<span class="fl">1e4</span>
  t&lt;-<span class="kw">runif</span>(m,<span class="dv">0</span>,a)<span class="co"># get the uniform sample</span>
  theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="dv">30</span><span class="op">*</span>a<span class="op">*</span>t<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>t)<span class="op">^</span><span class="dv">2</span>)<span class="co"># get the Monto Carlo estimate</span>
  <span class="kw">print</span>(theta.hat)
}
pv&lt;-<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>)
<span class="cf">for</span>(x <span class="cf">in</span> pv){
 <span class="kw">print</span>(x)
 <span class="kw">MCF</span>(x)
 <span class="kw">print</span>(<span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>))<span class="co">#use the pbeta function and compare with MCF</span>
}</code></pre></div>
<pre><code>## [1] 0.1
## [1] 0.008653314
## [1] 0.00856
## [1] 0.2
## [1] 0.05802282
## [1] 0.05792
## [1] 0.3
## [1] 0.1662394
## [1] 0.16308
## [1] 0.4
## [1] 0.3144435
## [1] 0.31744
## [1] 0.5
## [1] 0.4980498
## [1] 0.5
## [1] 0.6
## [1] 0.6766138
## [1] 0.68256
## [1] 0.7
## [1] 0.8310249
## [1] 0.83692
## [1] 0.8
## [1] 0.9388361
## [1] 0.94208
## [1] 0.9
## [1] 0.9851631
## [1] 0.99144</code></pre>
</div>
<div id="question-1" class="section level1">
<h1>question</h1>
<div id="exercise-5.9" class="section level3">
<h3>exercise 5.9</h3>
<p>The Rayleigh density [156, (18.76)] is <span class="math display">\[f(x)=\frac{x}{\sigma^2}e^\frac{-x^2}{2\sigma^2}\quad x&gt;=0, \sigma&gt;0.\]</span></p>
<p>Implement a function to generate samples from a Rayleigh(??) distribution.using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X'}{2}\)</span> compared with <span class="math inline">\(\frac{X1+X2}{2}\)</span> for independent X1, X2?</p>
</div>
</div>
<div id="answer-4" class="section level1">
<h1>answer</h1>
<p>We can get Rayleigh(??) distribution by the Rayleigh density.That is <span class="math display">\[F(x)=1-e^\frac{-x^2}{2\sigma^2}\quad x&gt;=0, \sigma&gt;0.\]</span> So,we can get the inverse function is <span class="math display">\[G(x)=\sqrt{-2\sigma^2ln(1-x)}\quad X=U(0,1).\]</span> by using antithetic variables,we can get samples from the Rayleigh(??) distribution. <span class="math display">\[\frac{X+X'}{2}=\frac{\sqrt{-2\sigma^2ln(1-x)}+\sqrt{-2\sigma^2ln(x)}}{2}\quad X=U(0,1).\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="fl">1e4</span>
x&lt;-<span class="kw">runif</span>(m,<span class="dv">0</span>,<span class="dv">1</span>)
a&lt;-(<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>x))<span class="op">+</span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(x)))<span class="op">/</span><span class="dv">2</span>
b&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>x))
<span class="kw">c</span>(<span class="kw">var</span>(a),<span class="kw">var</span>(b),<span class="kw">var</span>(b)<span class="op">/</span><span class="kw">var</span>(a))<span class="co">#compare the results</span></code></pre></div>
<pre><code>## [1]  0.01211678  0.43873936 36.20923948</code></pre>
</div>
<div id="question-2" class="section level1">
<h1>question</h1>
<div id="exercise-5.13" class="section level3">
<h3>exercise 5.13</h3>
<p>Find two importance functions f1 and f2 that are supported on (1,??) and are ??close?? to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^\frac{-x^2}{2}\quad x&gt;1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_{1}^{??}\frac{x^2}{\sqrt{2\pi}}e^\frac{-x^2}{2}dx\]</span> by importance sampling? Explain.</p>
</div>
</div>
<div id="answer-5" class="section level1">
<h1>answer</h1>
<p>We can get two importance functions f1 and f2 <span class="math display">\[f1(x)=\frac{1}{x^2}\quad x&gt;1.\]</span> <span class="math display">\[f2(x)=xe^\frac{1-x^2}{2}\quad x&gt;1.\]</span> So,we can get the cdf <span class="math display">\[F1(x)=1-\frac{1}{x}\quad x&gt;1.\]</span> <span class="math display">\[F2(x)=1-e^\frac{1-x^2}{2}\quad x&gt;1.\]</span> So,we can get the inverse function <span class="math display">\[H1(x)=\frac{1}{1-x}\quad X=U(0,1).\]</span> <span class="math display">\[H2(x)=\sqrt{1-2ln(1-x)}\quad X=U(0,1).\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="fl">1e4</span>
x&lt;-<span class="kw">runif</span>(m,<span class="dv">0</span>,<span class="dv">1</span>)
a&lt;-<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x)
b&lt;-<span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>x))
theta1&lt;-<span class="kw">sum</span>(a<span class="op">^</span><span class="dv">4</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">/</span>m<span class="co">#get the mean</span>
theta2&lt;-<span class="kw">sum</span>(b<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)))<span class="op">/</span>m
<span class="kw">print</span>(<span class="kw">c</span>(theta1,theta2))</code></pre></div>
<pre><code>## [1] 0.4061032 0.3991410</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">var1&lt;-<span class="kw">var</span>(a<span class="op">^</span><span class="dv">4</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="co">#get the variance</span>
var2&lt;-<span class="kw">var</span>(b<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)))
<span class="kw">print</span>(<span class="kw">c</span>(var1,var2))</code></pre></div>
<pre><code>## [1] 0.09258629 0.01467898</code></pre>
<p>So we can find the same mean,but f2 has the smaller variance. That is,f2 is the better importance function.</p>
</div>
<div id="question-3" class="section level1">
<h1>question</h1>
<div id="exercise-5.14" class="section level3">
<h3>exercise 5.14</h3>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[\int_{1}^{??}\frac{x^2}{\sqrt{2\pi}}e^\frac{-x^2}{2}dx\]</span> by importance sampling.</p>
</div>
</div>
<div id="answer-6" class="section level1">
<h1>answer</h1>
<p>We can get the importance functions f <span class="math display">\[f(x)=xe^\frac{1-x^2}{2}\quad x&gt;1.\]</span> So,we can get the cdf <span class="math display">\[F(x)=1-e^\frac{1-x^2}{2}\quad x&gt;1.\]</span> So,we can get the inverse function <span class="math display">\[H(x)=\sqrt{1-2ln(1-x)}\quad X=U(0,1).\]</span> So,<span class="math display">\[g(x)/f(x)=\frac{x}{\sqrt{2e\pi}}\quad x&gt;1.\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="fl">1e4</span>
x&lt;-<span class="kw">runif</span>(m,<span class="dv">0</span>,<span class="dv">1</span>)
b&lt;-<span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>x))
theta&lt;-<span class="kw">sum</span>(b<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)))<span class="op">/</span>m<span class="co">#get the mean</span>
<span class="kw">print</span>(theta)</code></pre></div>
<pre><code>## [1] 0.3992236</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">var2&lt;-<span class="kw">var</span>(b<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)))<span class="co">#get the variance</span>
<span class="kw">print</span>(var2)</code></pre></div>
<pre><code>## [1] 0.01477193</code></pre>
</div>
<div id="section-2" class="section level1">
<h1>3</h1>
</div>
<div id="question-4" class="section level1">
<h1>Question</h1>
<div id="exercise-6.9" class="section level3">
<h3>exercise 6.9</h3>
<p>Let X be a non-negative random variable with <span class="math inline">\(\mu=E\rvert{x}\rvert &lt; ??\)</span>. For a random sample x1,…,xn from the distribution of X, the Gini ratio is defined by <span class="math display">\[G=\frac{1}{2n^2\mu}\sum_{j=1}^{n}\sum_{i=1}^{n}\rvert{x_i-x_j}\rvert\]</span> The Gini ratio is applied in economics to measure inequality in income distribution (see e.g. [163]). Note that G can be written in terms of the order statistics $x_(i) as <span class="math display">\[G=\frac{1}{n^2\mu}\sum_{i=1}^{n}(2i-n-1)x_{(i)}\]</span> If the mean is unknown,let <span class="math inline">\(\widehat{G}\)</span> be the statistic G with ?? replaced by <span class="math inline">\(\overline{x}\)</span>. Estimate by simulation the mean, median and deciles of <span class="math inline">\(\widehat{G}\)</span> if X is standard lognormal. Repeat the procedure for the uniform distribution and Bernoulli(0.1). Also construct density histograms of the replicates in each case.</p>
</div>
</div>
<div id="answer-7" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="fl">1e3</span>
n&lt;-<span class="dv">100</span> 
G.hat&lt;-<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ 
  x&lt;-<span class="kw">rlnorm</span>(n)<span class="co">#X is standard lognormal</span>
  mu&lt;-<span class="kw">mean</span>(x)
  sum0&lt;-<span class="dv">0</span>
  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
      sum0&lt;-sum0<span class="op">+</span><span class="kw">abs</span>(x[j]<span class="op">-</span>x[k])
    }
  }
  G.hat[i]&lt;-sum0<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n<span class="op">^</span><span class="dv">2</span><span class="op">*</span>mu)
}
<span class="kw">print</span>(<span class="kw">c</span>(<span class="dt">G.mean=</span><span class="kw">mean</span>(G.hat),<span class="dt">G.median=</span><span class="kw">median</span>(G.hat),<span class="dt">G.deciles=</span><span class="kw">quantile</span>(G.hat,<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>))))</code></pre></div>
<pre><code>##        G.mean      G.median G.deciles.10% G.deciles.90% 
##     0.5130236     0.5090968     0.4634670     0.5671024</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G.hat,<span class="dt">freq =</span> <span class="ot">FALSE</span>)
<span class="kw">lines</span>(<span class="kw">density</span>(G.hat))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="fl">1e3</span>
n&lt;-<span class="dv">10</span> 
G.hat&lt;-<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ 
  x&lt;-<span class="kw">runif</span>(n)<span class="co">#uniform distribution</span>
  mu&lt;-<span class="kw">mean</span>(x)
  sum0&lt;-<span class="dv">0</span>
  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
      sum0&lt;-sum0<span class="op">+</span><span class="kw">abs</span>(x[j]<span class="op">-</span>x[k])
    }
  }
  G.hat[i]&lt;-sum0<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n<span class="op">^</span><span class="dv">2</span><span class="op">*</span>mu)
}
<span class="kw">print</span>(<span class="kw">c</span>(<span class="dt">G.mean=</span><span class="kw">mean</span>(G.hat),<span class="dt">G.median=</span><span class="kw">median</span>(G.hat),<span class="dt">G.deciles=</span><span class="kw">quantile</span>(G.hat,<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>))))</code></pre></div>
<pre><code>##        G.mean      G.median G.deciles.10% G.deciles.90% 
##     0.3095617     0.3059000     0.2113061     0.4070990</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G.hat,<span class="dt">freq =</span> <span class="ot">FALSE</span>)
<span class="kw">lines</span>(<span class="kw">density</span>(G.hat))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="fl">1e3</span>
n&lt;-<span class="dv">10</span> 
G.hat&lt;-<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ 
  x&lt;-<span class="kw">rbinom</span>(n,m,<span class="fl">0.1</span>)<span class="co">#Bernoulli(0.1)</span>
  mu&lt;-<span class="kw">mean</span>(x)
  sum0&lt;-<span class="dv">0</span>
  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
      sum0&lt;-sum0<span class="op">+</span><span class="kw">abs</span>(x[j]<span class="op">-</span>x[k])
    }
  }
  G.hat[i]&lt;-sum0<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n<span class="op">^</span><span class="dv">2</span><span class="op">*</span>mu)
}
<span class="kw">print</span>(<span class="kw">c</span>(<span class="dt">G.mean=</span><span class="kw">mean</span>(G.hat),<span class="dt">G.median=</span><span class="kw">median</span>(G.hat),<span class="dt">G.deciles=</span><span class="kw">quantile</span>(G.hat,<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>))))</code></pre></div>
<pre><code>##        G.mean      G.median G.deciles.10% G.deciles.90% 
##    0.04822970    0.04750618    0.03333333    0.06369396</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G.hat,<span class="dt">freq =</span> <span class="ot">FALSE</span>)
<span class="kw">lines</span>(<span class="kw">density</span>(G.hat))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="exercise-6.10" class="section level3">
<h3>exercise 6.10</h3>
<p>Construct an approximate 95% confidence interval for the Gini ratio <span class="math inline">\(\gamma=E[G]\)</span> if X is lognormal with unknown parameters. Assess the coverage rate of the estimation procedure with a Monte Carlo experiment.</p>
</div>
</div>
<div id="answer-8" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n&lt;-<span class="dv">50</span>
m&lt;-<span class="dv">100</span>
k&lt;-<span class="dv">200</span>
G1&lt;-<span class="kw">numeric</span>(m)
Grlnorm&lt;-<span class="cf">function</span>(n){
  x&lt;-<span class="kw">rlnorm</span>(n)
  mu&lt;-<span class="kw">mean</span>(x)
  sum0&lt;-<span class="dv">0</span>
  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
      sum0&lt;-sum0<span class="op">+</span><span class="kw">abs</span>(x[j]<span class="op">-</span>x[k])
    }
  }
  <span class="kw">return</span>(sum0<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n<span class="op">^</span><span class="dv">2</span><span class="op">*</span>mu))
}
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  G1[i]&lt;-<span class="kw">Grlnorm</span>(n)
}
gamma.mean&lt;-<span class="kw">mean</span>(G1)
gamma.sd&lt;-<span class="kw">sd</span>(G1)
a&lt;-gamma.mean<span class="op">-</span><span class="kw">qt</span>(<span class="fl">0.95</span>,<span class="dt">df=</span>m<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>gamma.sd<span class="op">/</span><span class="kw">sqrt</span>(m)
b&lt;-gamma.mean<span class="op">+</span><span class="kw">qt</span>(<span class="fl">0.95</span>,<span class="dt">df=</span>m<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>gamma.sd<span class="op">/</span><span class="kw">sqrt</span>(m)<span class="co">#confidence interval(a,b)</span>
gamma1&lt;-<span class="kw">numeric</span>(k)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){
  G2&lt;-<span class="kw">numeric</span>(m)
  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
    G2[j]&lt;-<span class="kw">Grlnorm</span>(n)
  }
  gamma1[i]&lt;-<span class="kw">mean</span>(G2)
}
<span class="kw">cat</span>(<span class="st">'The confidence interval of gamma is ('</span>,<span class="kw">round</span>(a,<span class="dv">4</span>),<span class="st">','</span>,<span class="kw">round</span>(b,<span class="dv">4</span>),<span class="st">'),and the coverage rate is '</span>,<span class="kw">round</span>(<span class="kw">sum</span>(gamma1<span class="op">&gt;</span>a<span class="op">&amp;</span>gamma1<span class="op">&lt;</span>b)<span class="op">/</span>k,<span class="dv">3</span>)<span class="op">*</span><span class="dv">100</span>,<span class="st">'%'</span>,<span class="dt">sep =</span> <span class="st">''</span>)</code></pre></div>
<pre><code>## The confidence interval of gamma is (0.4867,0.5054),and the coverage rate is 58%</code></pre>
<div id="exercise-6.b" class="section level3">
<h3>exercise 6.B</h3>
<p>Tests for association based on Pearson product moment correlation ??, Spearman??s rank correlation coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall??s coefficient ??, are implemented in cor.test. Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or ?? are less powerful than the correlation test when the sampled distribution is bivariate normal. Find an example of an alternative (a bivariate distribution (X,Y) such that X and Y are dependent) such that at least one of the nonparametric tests have better empirical power than the correlation test against this alternative.</p>
</div>
</div>
<div id="answer-9" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
n&lt;-<span class="dv">100</span>
m&lt;-<span class="dv">1000</span>
pearson.p&lt;-<span class="kw">numeric</span>(m)
kendall.p&lt;-<span class="kw">numeric</span>(m)
spearman.p&lt;-<span class="kw">numeric</span>(m)

sigma0&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="dv">1</span>),<span class="dt">ncol =</span> <span class="dv">2</span>)<span class="co">#bivariate normal</span>
mu&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  mlnorm&lt;-<span class="kw">mvrnorm</span>(n,mu,sigma0)
  x&lt;-mlnorm[,<span class="dv">1</span>]
  y&lt;-mlnorm[,<span class="dv">2</span>]
  pearson&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">'pearson'</span>)
  kendall&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">'kendall'</span>)
  spearman&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">'spearman'</span>)
  pearson.p[i]&lt;-pearson<span class="op">$</span>p.value
  kendall.p[i]&lt;-kendall<span class="op">$</span>p.value
  spearman.p[i]&lt;-spearman<span class="op">$</span>p.value
}
<span class="kw">cat</span>(<span class="st">'pearson:'</span>,<span class="kw">sum</span>(pearson.p<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span>m,
    <span class="st">'kendall:'</span>,<span class="kw">sum</span>(kendall.p<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span>m,
    <span class="st">'spearman:'</span>,<span class="kw">sum</span>(spearman.p<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span>m)<span class="co">#reject the null hypothesis</span></code></pre></div>
<pre><code>## pearson: 0.533 kendall: 0.474 spearman: 0.482</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
n&lt;-<span class="dv">100</span>
m&lt;-<span class="dv">1000</span>
pearson.p&lt;-<span class="kw">numeric</span>(m)
kendall.p&lt;-<span class="kw">numeric</span>(m)
spearman.p&lt;-<span class="kw">numeric</span>(m)

sigma0&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol =</span> <span class="dv">2</span>)<span class="co">#X and Y are dependent</span>
mu&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  mlnorm&lt;-<span class="kw">mvrnorm</span>(n,mu,sigma0)
  x&lt;-mlnorm[,<span class="dv">1</span>]
  y&lt;-mlnorm[,<span class="dv">2</span>]
  pearson&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">'pearson'</span>)
  kendall&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">'kendall'</span>)
  spearman&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">'spearman'</span>)
  pearson.p[i]&lt;-pearson<span class="op">$</span>p.value
  kendall.p[i]&lt;-kendall<span class="op">$</span>p.value
  spearman.p[i]&lt;-spearman<span class="op">$</span>p.value
}
<span class="kw">cat</span>(<span class="st">'pearson:'</span>,<span class="kw">sum</span>(pearson.p<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span>m,
    <span class="st">'kendall:'</span>,<span class="kw">sum</span>(kendall.p<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span>m,
    <span class="st">'spearman:'</span>,<span class="kw">sum</span>(spearman.p<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="op">/</span>m)<span class="co">#accept the null hypothesis</span></code></pre></div>
<pre><code>## pearson: 0.052 kendall: 0.048 spearman: 0.046</code></pre>
</div>
<div id="section-3" class="section level1">
<h1>4</h1>
</div>
<div id="question-5" class="section level1">
<h1>Question</h1>
<div id="exercise-7.1" class="section level3">
<h3>Exercise 7.1</h3>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
</div>
<div id="answer-10" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap)
n&lt;-<span class="kw">nrow</span>(law)    <span class="co">#sample size</span>
theta.jack&lt;-<span class="kw">numeric</span>(n) <span class="co">#storage for replicates</span>
b.cor&lt;-<span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>])
theta.hat&lt;-<span class="kw">b.cor</span>(law,<span class="dv">1</span><span class="op">:</span>n)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  theta.jack[i]&lt;-<span class="kw">b.cor</span>(law,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i])
}
bias.jack&lt;-(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat) 
se.jack&lt;-<span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>)) 
<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat,<span class="dt">bias=</span>bias.jack, <span class="dt">se=</span>se.jack),<span class="dv">3</span>)</code></pre></div>
<pre><code>## original     bias       se 
##    0.776   -0.006    0.143</code></pre>
</div>
<div id="section-4" class="section level1">
<h1>5</h1>
</div>
<div id="question-6" class="section level1">
<h1>Question</h1>
<div id="exercise-7.1-1" class="section level3">
<h3>Exercise 7.1</h3>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
</div>
<div id="answer-11" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap)
n&lt;-<span class="kw">nrow</span>(law)    <span class="co">#sample size</span>
theta.jack&lt;-<span class="kw">numeric</span>(n) <span class="co">#storage for replicates</span>
b.cor&lt;-<span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>])
theta.hat&lt;-<span class="kw">b.cor</span>(law,<span class="dv">1</span><span class="op">:</span>n)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  theta.jack[i]&lt;-<span class="kw">b.cor</span>(law,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i])
}
bias.jack&lt;-(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat) 
se.jack&lt;-<span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>)) 
<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat,<span class="dt">bias=</span>bias.jack, <span class="dt">se=</span>se.jack),<span class="dv">3</span>)</code></pre></div>
<pre><code>## original     bias       se 
##    0.776   -0.006    0.143</code></pre>
<div id="exercise-7.4" class="section level3">
<h3>Exercise 7.4</h3>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures 1/?? by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may di???er.</p>
</div>
</div>
<div id="answer-12" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)
<span class="kw">set.seed</span>(<span class="dv">1</span>)
n&lt;-<span class="kw">nrow</span>(aircondit) <span class="co">#sample size</span>
<span class="kw">mean</span>(aircondit[,<span class="dv">1</span>])</code></pre></div>
<pre><code>## [1] 108.0833</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">boot.mean&lt;-<span class="cf">function</span>(x,i) <span class="kw">mean</span>(x[i,<span class="dv">1</span>]) <span class="co">#give the mean function</span>
boot.out&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>aircondit,<span class="dt">statistic=</span>boot.mean,<span class="dt">R=</span><span class="dv">1000</span>)
<span class="kw">boot.ci</span>(boot.out,<span class="dt">conf=</span><span class="fl">0.95</span>)</code></pre></div>
<pre><code>## Warning in boot.ci(boot.out, conf = 0.95): bootstrap variances needed for
## studentized intervals</code></pre>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.out, conf = 0.95)
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 31.7, 181.8 )   ( 25.8, 170.9 )  
## 
## Level     Percentile            BCa          
## 95%   ( 45.3, 190.4 )   ( 53.3, 214.6 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>we can find 95% bootstrap confidence intervals are different,because we use different test types.</p>
<div id="exercise-7.8" class="section level3">
<h3>Exercise 7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
</div>
<div id="answer-13" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap)
n&lt;-<span class="kw">nrow</span>(scor)
theta.jack&lt;-<span class="kw">numeric</span>(n)
n&lt;-<span class="kw">nrow</span>(scor)
theta.jack&lt;-<span class="kw">numeric</span>(n)
scor.pr&lt;-<span class="cf">function</span>(x,i){
  a&lt;-<span class="kw">eigen</span>(<span class="kw">cor</span>(x[i,]))
  a<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(a<span class="op">$</span>values) <span class="co"># the proportion of variance </span>
}
theta.hat&lt;-<span class="kw">scor.pr</span>(scor,<span class="dv">1</span><span class="op">:</span>n)
<span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  theta.jack[j]&lt;-<span class="kw">scor.pr</span>(scor,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>j])
}
bias.jack&lt;-(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat) 
se.jack&lt;-<span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>)) 
<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat,<span class="dt">bias=</span>bias.jack, <span class="dt">se=</span>se.jack),<span class="dv">3</span>)</code></pre></div>
<pre><code>## original     bias       se 
##    0.636    0.000    0.045</code></pre>
<div id="exercise-7.11" class="section level3">
<h3>Exercise 7.11</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
</div>
<div id="answer-14" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DAAG)</code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：'lattice'</code></pre>
<pre><code>## The following object is masked from 'package:boot':
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：'DAAG'</code></pre>
<pre><code>## The following object is masked from 'package:MASS':
## 
##     hills</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(ironslag)
n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag </span>
e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>n) <span class="co">#the size of samples</span>
k=<span class="dv">1</span> 
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="op">-</span><span class="dv">1</span>)){
  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){   
  y&lt;-<span class="st"> </span>magnetic[<span class="op">-</span>i][<span class="op">-</span>(j<span class="op">-</span><span class="dv">1</span>)]
  x&lt;-<span class="st"> </span>chemical[<span class="op">-</span>i][<span class="op">-</span>(j<span class="op">-</span><span class="dv">1</span>)] <span class="co">#leave-two-out samples</span>

  
  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) 
  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] 
  e1[k] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat1  <span class="co">#check out the modle</span>
  
  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) 
  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">2</span> 
  e2[k] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat2
  
  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) 
  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] 
  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3) 
  e3[k] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat3
  
  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x)) 
  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[i]) 
  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4) 
  e4[k] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat4
  
  k&lt;-k<span class="op">+</span><span class="dv">1</span>

  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j] 
  e1[k] &lt;-<span class="st"> </span>magnetic[j] <span class="op">-</span><span class="st"> </span>yhat1 
  
  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[j]<span class="op">^</span><span class="dv">2</span> 
  e2[k] &lt;-<span class="st"> </span>magnetic[j] <span class="op">-</span><span class="st"> </span>yhat2
  
  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j] 
  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3) 
  e3[k] &lt;-<span class="st"> </span>magnetic[j] <span class="op">-</span><span class="st"> </span>yhat3
  
  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[j]) 
  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4) 
  e4[k] &lt;-<span class="st"> </span>magnetic[j] <span class="op">-</span><span class="st"> </span>yhat4
  
  k&lt;-k<span class="op">+</span><span class="dv">1</span>
  
  }
}
<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)) <span class="co">#get the square error</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(<span class="dt">formula =</span> magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data. The fitted regression equation for Model 2 is <span class="math display">\[\hat{Y}=24.49262-1.39334X+0.05452X^2\]</span></p>
<p>Compare with the leave-one-out (n-fold) cross validation,the leave-two-out cross validation has same conclusion,but more complicated,more accurate.</p>
</div>
<div id="section-5" class="section level1">
<h1>6</h1>
</div>
<div id="question-7" class="section level1">
<h1>Question</h1>
<div id="exercise-8.1" class="section level3">
<h3>exercise 8.1</h3>
<p>Implement the two-sample Cramer-von Mises test for equal distributions as a permutation test. Apply the test to the data in Examples 8.1 and 8.2.</p>
</div>
</div>
<div id="answer-15" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">attach</span>(chickwts) 
x &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;soybean&quot;</span>])) 
y &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;linseed&quot;</span>])) 
<span class="kw">detach</span>(chickwts)
n&lt;-<span class="kw">length</span>(x)
m&lt;-<span class="kw">length</span>(y)
R&lt;-<span class="dv">999</span> <span class="co">#repeat</span>
z&lt;-<span class="kw">c</span>(x,y)
h&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">26</span>
reps&lt;-<span class="kw">numeric</span>(R)
cvm&lt;-<span class="cf">function</span>(a,b){
  F&lt;-<span class="kw">ecdf</span>(a)
  G&lt;-<span class="kw">ecdf</span>(b)
  m<span class="op">*</span>n<span class="op">*</span>(<span class="kw">sum</span>((<span class="kw">F</span>(a)<span class="op">-</span><span class="kw">G</span>(a))<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">sum</span>((<span class="kw">F</span>(b)<span class="op">-</span><span class="kw">G</span>(b))<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>((m<span class="op">+</span>n)<span class="op">^</span><span class="dv">2</span>)
}
w0&lt;-<span class="kw">cvm</span>(x,y)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) { 
  k &lt;-<span class="st"> </span><span class="kw">sample</span>(h, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>) 
  x1 &lt;-<span class="st"> </span>z[k]
  y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k]
  reps[i] &lt;-<span class="kw">cvm</span>(x1,y1)
}<span class="co">#permutation test</span>
p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(w0, reps)) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(w0)) 
<span class="kw">round</span>(p,<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 0.421</code></pre>
<p>because p=0.421&gt;0.05,so we can not reject.</p>
<div id="exercise" class="section level3">
<h3>exercise</h3>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<p>Unequal variances and equal expectations</p>
<p>we can change the parameter to solve the problem.</p>
</div>
</div>
<div id="answer-16" class="section level1">
<h1>Answer</h1>
<p>we can change the mu</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Ball)</code></pre></div>
<pre><code>## 载入需要的程辑包：gam</code></pre>
<pre><code>## 载入需要的程辑包：splines</code></pre>
<pre><code>## 载入需要的程辑包：foreach</code></pre>
<pre><code>## Loaded gam 1.16</code></pre>
<pre><code>## 载入需要的程辑包：survival</code></pre>
<pre><code>## 
## 载入程辑包：'survival'</code></pre>
<pre><code>## The following object is masked from 'package:DAAG':
## 
##     lung</code></pre>
<pre><code>## The following object is masked from 'package:boot':
## 
##     aml</code></pre>
<pre><code>## 载入需要的程辑包：mvtnorm</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(energy)
<span class="kw">library</span>(boot)
<span class="kw">library</span>(RANN)
m &lt;-<span class="st"> </span><span class="fl">1e3</span>
k&lt;-<span class="dv">3</span>
p&lt;-<span class="dv">2</span>
mu &lt;-<span class="st"> </span><span class="fl">0.5</span>
<span class="kw">set.seed</span>(<span class="dv">12345</span>) 
n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span> 
R&lt;-<span class="dv">999</span>
n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2
N =<span class="st"> </span><span class="kw">c</span>(n1,n2) 
eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){ 
  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k) 
  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t) 
  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>]) 
  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value) 
} 
p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k){ 
  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>] 
  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>] 
  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2 
  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) 
    z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>); 
  z &lt;-<span class="st"> </span>z[ix, ]
  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)
  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] 
  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] 
  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>) 
  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>) 
  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n) 
} 
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ 
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p); 
  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu)); 
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value 
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value 
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value 
}<span class="co">#get p.values by the NN, energy, and ball methods.</span>
alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
<span class="kw">round</span>(pow,<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 0.178 0.374 0.300</code></pre>
<p>Unequal variances and unequal expectations</p>
</div>
<div id="answer-17" class="section level1">
<h1>Answer</h1>
<p>we can change the sd</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Ball)
<span class="kw">library</span>(energy)
<span class="kw">library</span>(boot)
<span class="kw">library</span>(RANN)
m &lt;-<span class="st"> </span><span class="fl">1e3</span>
k&lt;-<span class="dv">3</span>
p&lt;-<span class="dv">2</span>
sd1&lt;-<span class="dv">2</span>
<span class="kw">set.seed</span>(<span class="dv">12345</span>) 
n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span> 
R&lt;-<span class="dv">999</span>
n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2
N =<span class="st"> </span><span class="kw">c</span>(n1,n2) 
eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){ 
  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k) 
  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t) 
  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>]) 
  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value) 
} 
p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k){ 
  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>] 
  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>] 
  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2 
  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) 
    z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>)
  z &lt;-<span class="st"> </span>z[ix, ]
  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) 
  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] 
  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] 
  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>) 
  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>) 
  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n) 
} 
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ 
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p)
  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">sd=</span>sd1))
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value 
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value 
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value 
}
alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
<span class="kw">round</span>(pow,<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 0.384 0.363 0.633</code></pre>
<p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
</div>
<div id="answer-18" class="section level1">
<h1>Answer</h1>
<p>we can change the df</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Ball)
<span class="kw">library</span>(energy)
<span class="kw">library</span>(boot)
<span class="kw">library</span>(RANN)
m &lt;-<span class="st"> </span><span class="fl">1e3</span>
df&lt;-<span class="dv">1</span>
df2&lt;-<span class="dv">2</span>
k&lt;-<span class="dv">3</span>
p&lt;-<span class="dv">2</span>
<span class="kw">set.seed</span>(<span class="dv">12345</span>) 
n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span>
R&lt;-<span class="dv">999</span>
n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2
N =<span class="st"> </span><span class="kw">c</span>(n1,n2) 
eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){ 
  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k) 
  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t) 
  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>]) 
  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value) 
} 
p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k){ 
  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>] 
  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>] 
  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2 
  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) 
    z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>)
  z &lt;-<span class="st"> </span>z[ix, ]
  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)
  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] 
  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] 
  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>) 
  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>) 
  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n) 
} 
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ 
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dt">df=</span>df),<span class="dt">ncol=</span>p)
  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rt</span>(n2,<span class="dt">df=</span>df),<span class="kw">rt</span>(n2,<span class="dt">df=</span>df2))
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value 
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value 
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value 
}
alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
<span class="kw">round</span>(pow,<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 0.108 0.133 0.162</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Ball)
<span class="kw">library</span>(energy)
<span class="kw">library</span>(boot)
<span class="kw">library</span>(RANN)
m &lt;-<span class="st"> </span><span class="fl">1e3</span>
t&lt;-<span class="fl">0.8</span>
k&lt;-<span class="dv">3</span>
p&lt;-<span class="dv">2</span>
<span class="kw">set.seed</span>(<span class="dv">12345</span>) 
n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span>
R&lt;-<span class="dv">999</span>
n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2
N =<span class="st"> </span><span class="kw">c</span>(n1,n2) 
eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){ 
  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k) 
  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t) 
  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>]) 
  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value) 
} 
p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k){ 
  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>] 
  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>] 
  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2 
  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) 
    z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>)
  z &lt;-<span class="st"> </span>z[ix, ]
  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)
  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] 
  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] 
  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>) 
  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>) 
  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n) 
} 
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ 
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rbinom</span>(n1<span class="op">*</span>p,<span class="dv">1</span>,<span class="fl">0.5</span>),<span class="dt">ncol=</span>p)
  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rbinom</span>(n2,<span class="dv">1</span>,<span class="fl">0.5</span>),<span class="kw">rbinom</span>(n2,<span class="dv">1</span>,t))
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value 
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value 
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value 
}
alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
<span class="kw">round</span>(pow,<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 0.361 0.518 0.458</code></pre>
<p>Unbalanced samples</p>
</div>
<div id="answer-19" class="section level1">
<h1>Answer</h1>
<p>we can change the n1,n2</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Ball)
<span class="kw">library</span>(energy)
<span class="kw">library</span>(boot)
<span class="kw">library</span>(RANN)
m &lt;-<span class="st"> </span><span class="fl">1e3</span>
k&lt;-<span class="dv">3</span>
p&lt;-<span class="dv">2</span>
<span class="kw">set.seed</span>(<span class="dv">12345</span>) 
n1&lt;-<span class="dv">20</span>
n2&lt;-<span class="dv">30</span>
R&lt;-<span class="dv">999</span>
n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2
N =<span class="st"> </span><span class="kw">c</span>(n1,n2) 
eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){ 
  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k) 
  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t) 
  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>]) 
  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value) 
} 
p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k){ 
  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>] 
  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>] 
  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2 
  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) 
    z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>); 
  z &lt;-<span class="st"> </span>z[ix, ]
  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)
  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] 
  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] 
  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>) 
  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>) 
  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n) 
} 
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ 
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p)
  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2))
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value 
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value 
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value 
}
alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
<span class="kw">round</span>(pow,<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 0.095 0.102 0.104</code></pre>
<div id="exercise-9.3" class="section level3">
<h3>exercise 9.3</h3>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the ???rst 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution(see qcauchy or qt with df=1). Recall that a Cauchy(??,??) distribution has density function <span class="math display">\[f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)}\quad ,\theta&gt;0\]</span> The standard Cauchy has the Cauchy(?? =1,??= 0) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
</div>
</div>
<div id="answer-20" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)

m&lt;-<span class="dv">20000</span> <span class="co">#length of the chain</span>
x&lt;-<span class="kw">numeric</span>(m)
y&lt;-<span class="kw">numeric</span>(m<span class="op">-</span><span class="dv">1000</span>)
x[<span class="dv">1</span>]&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)

standard_cauchy&lt;-<span class="cf">function</span>(x){
  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>(pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)))
}

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(m<span class="op">-</span><span class="dv">1</span>)){
  proposal&lt;-x[i]<span class="op">+</span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="dt">min=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">max=</span><span class="dv">1</span>)
  accept&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)<span class="op">&lt;=</span><span class="kw">standard_cauchy</span>(proposal)<span class="op">/</span><span class="kw">standard_cauchy</span>(x[i])
  x[i<span class="op">+</span><span class="dv">1</span>]&lt;-<span class="kw">ifelse</span>(accept<span class="op">==</span>T,proposal,x[i])
}

y&lt;-x[<span class="dv">1001</span><span class="op">:</span>m]

<span class="kw">quantile</span>(y,<span class="dt">probs =</span> <span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))</code></pre></div>
<pre><code>##         10%         20%         30%         40%         50%         60% 
## -2.68474979 -1.22085681 -0.60227674 -0.22692955  0.09615792  0.45686422 
##         70%         80%         90% 
##  0.91602211  1.78290203  5.34850141</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qcauchy</span>(<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))</code></pre></div>
<pre><code>## [1] -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000  0.3249197
## [7]  0.7265425  1.3763819  3.0776835</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqnorm</span>(y)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="exercise-9.6" class="section level3">
<h3>exercise 9.6</h3>
<p>Rao [220, Sec. 5g] presented an example on genetic linkage of 197 animals in four categories (also discussed in [67, 106, 171, 266]). The group sizes are(125,18,20,34). Assume that the probabilities of the corresponding multinomial distribution are <span class="math display">\[(\frac{1}{2}+\frac{\theta}{4},\frac{1-\theta}{4},\frac{1-\theta}{4},\frac{\theta}{4})\]</span> Estimate the posterior distribution of ?? given the observed sample, using one of the methods in this chapter.</p>
</div>
</div>
<div id="answer-21" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
m&lt;-<span class="dv">10000</span> <span class="co">#length of the chain</span>
w&lt;-<span class="fl">0.25</span> <span class="co">#width</span>
u&lt;-<span class="kw">runif</span>(m)
v&lt;-<span class="kw">runif</span>(m,<span class="op">-</span>w,w)
group&lt;-<span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>)
x&lt;-<span class="kw">numeric</span>(m)

prob&lt;-<span class="cf">function</span>(theta){
  <span class="cf">if</span>(theta<span class="op">&lt;</span><span class="dv">0</span><span class="op">||</span>theta<span class="op">&gt;=</span><span class="fl">0.8</span>) 
    <span class="kw">return</span>(<span class="dv">0</span>)
  <span class="cf">else</span>
    <span class="kw">return</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">+</span>theta<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>group[<span class="dv">1</span>]<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>theta)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>group[<span class="dv">2</span>]<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>theta)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>group[<span class="dv">3</span>]<span class="op">*</span>(theta<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>group[<span class="dv">4</span>])
}

x[<span class="dv">1</span>]&lt;-<span class="fl">0.3</span> <span class="co">#initial value</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m){
  theta&lt;-x[i<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span>v[i]
  <span class="cf">if</span>(u[i]<span class="op">&lt;=</span><span class="kw">prob</span>(theta)<span class="op">/</span><span class="kw">prob</span>(x[i<span class="op">-</span><span class="dv">1</span>]))
    x[i]&lt;-theta
  <span class="cf">else</span>
    x[i]&lt;-x[i<span class="op">-</span><span class="dv">1</span>]
}

theta.hat&lt;-<span class="kw">mean</span>(x[<span class="dv">1001</span><span class="op">:</span>m])
<span class="kw">print</span>(theta.hat)</code></pre></div>
<pre><code>## [1] 0.6229572</code></pre>
</div>
<div id="section-6" class="section level1">
<h1>7</h1>
</div>
<div id="question-8" class="section level1">
<h1>Question</h1>
<div id="exercise-9.6-1" class="section level3">
<h3>Exercise 9.6</h3>
<p>For exercise 9.6, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until the chain has converged approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
</div>
<div id="answer-22" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b=<span class="dv">1000</span>
m=<span class="dv">10000</span>
N=b<span class="op">+</span>m
Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi){ 
  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j]) </span>
  <span class="co"># for chain in i-th row of X </span>
  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi) 
  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi) 
  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)
  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means </span>
  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est. </span>
  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances </span>
  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est. </span>
  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>(n<span class="op">*</span>k)) <span class="co">#upper variance est. </span>
  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic return(r.hat) </span>
}
iden&lt;-<span class="cf">function</span>(theta){
  <span class="dv">125</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">+</span>theta)<span class="op">+</span><span class="dv">38</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>theta)<span class="op">+</span><span class="dv">34</span><span class="op">*</span><span class="kw">log</span>(theta)
}
MCMC&lt;-<span class="cf">function</span>(x,<span class="dt">print_acc=</span>F){
  y=<span class="dv">1</span><span class="op">:</span>N
  acc=<span class="dv">0</span>
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
    p=<span class="kw">runif</span>(<span class="dv">1</span>)
    y[i]=x=<span class="cf">if</span>(<span class="kw">runif</span>(<span class="dv">1</span>)<span class="op">&lt;</span><span class="kw">exp</span>(<span class="kw">iden</span>(p)<span class="op">-</span><span class="kw">iden</span>(x))){acc=acc<span class="op">+</span><span class="dv">1</span>;p}<span class="cf">else</span> x
  }
  <span class="cf">if</span>(print_acc) <span class="kw">print</span>(acc<span class="op">/</span>N)
  y[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N]
}
<span class="kw">plot</span>(<span class="kw">MCMC</span>(<span class="fl">0.5</span>,<span class="dt">print_acc =</span> T))</code></pre></div>
<pre><code>## [1] 0.1602727</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">M1=<span class="kw">cumsum</span>((<span class="dt">MC1=</span><span class="kw">MCMC</span>(<span class="fl">0.2</span>)))<span class="op">/</span><span class="dv">1</span><span class="op">:</span>m
M2=<span class="kw">cumsum</span>((<span class="dt">MC2=</span><span class="kw">MCMC</span>(<span class="fl">0.4</span>)))<span class="op">/</span><span class="dv">1</span><span class="op">:</span>m
M3=<span class="kw">cumsum</span>((<span class="dt">MC3=</span><span class="kw">MCMC</span>(<span class="fl">0.6</span>)))<span class="op">/</span><span class="dv">1</span><span class="op">:</span>m
M4=<span class="kw">cumsum</span>((<span class="dt">MC4=</span><span class="kw">MCMC</span>(<span class="fl">0.8</span>)))<span class="op">/</span><span class="dv">1</span><span class="op">:</span>m
psi=<span class="kw">rbind</span>(M1,M2,M3,M4)
<span class="kw">plot</span>((<span class="dt">R=</span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="cf">function</span>(i)<span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>i]))),<span class="dt">main=</span><span class="st">&quot;R value of Gelman.Rubin method&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">c</span>(MC1[<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>],MC2[<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>],MC3[<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>],MC4[<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>])),<span class="kw">var</span>(<span class="kw">c</span>(MC1[<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>],MC2[<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>],MC3[<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>],MC4[<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>])))</code></pre></div>
<pre><code>## [1] 0.623428767 0.002489491</code></pre>
<div id="exercise-11.4" class="section level3">
<h3>exercise 11.4</h3>
<p>Find the intersection points A(k) in <span class="math inline">\((0,\sqrt{k})\)</span>of the curves <span class="math display">\[S_{k-1}(a)=P\big(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}}\big)\]</span> and <span class="math display">\[S_{k}(a)=P\big(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}}\big)\]</span> for k =4:25,100,500,1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz??ekely [260].)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alpha&lt;-<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">25</span>)
b&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>){
  k=b[i]
inter&lt;-<span class="cf">function</span>(a){
  <span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">*</span>a<span class="op">*</span>(k<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">*</span>a)),<span class="dt">df=</span>k<span class="op">-</span><span class="dv">1</span>,<span class="dt">lower.tail=</span>F,<span class="dt">log.p=</span>T)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">*</span>a<span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">*</span>a)),<span class="dt">df=</span>k,<span class="dt">lower.tail=</span>F,<span class="dt">log.p=</span>T)
}
solution &lt;-<span class="st"> </span><span class="kw">uniroot</span>(inter,<span class="dt">lower=</span><span class="fl">0.0001</span>,<span class="dt">upper=</span><span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.0001</span>)
alpha[i]&lt;-<span class="st"> </span>solution<span class="op">$</span>root
<span class="kw">print</span>(alpha[i])
}<span class="co">#intersection points</span></code></pre></div>
<pre><code>## [1] 1.49209
## [1] 1.533554
## [1] 1.562754
## [1] 1.584418
## [1] 1.60118
## [1] 1.614514
## [1] 1.625379
## [1] 1.634409
## [1] 1.642024
## [1] 1.64854
## [1] 1.654173
## [1] 1.659098
## [1] 1.663459
## [1] 1.667283
## [1] 1.670705
## [1] 1.673847
## [1] 1.676613
## [1] 1.679154
## [1] 1.681467
## [1] 1.683565
## [1] 1.685546
## [1] 1.687347
## [1] 1.720616
## [1] 1.729718
## [1] 1.730897</code></pre>
</div>
</div>
<div id="section-7" class="section level1">
<h1>8</h1>
</div>
<div id="section-8" class="section level1">
<h1>11.6</h1>
<p>Write a function to compute the cdf of the Cauchy distribution, which has density<span class="math display">\[f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)}\quad -\infty&lt;x&lt;\infty\]</span>where <span class="math inline">\(\theta\)</span> &gt; 0. Compare your results to the results from the R function pcauchy. (Also see the source code in pcauchy.c.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cdfCauchy =<span class="st"> </span><span class="cf">function</span>(q, <span class="dt">eta=</span><span class="dv">0</span>, <span class="dt">theta=</span><span class="dv">1</span>) {
pdf =<span class="st"> </span><span class="cf">function</span>(x,eta,theta){ <span class="dv">1</span><span class="op">/</span>(theta<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>((x<span class="op">-</span>eta)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>)) }
 result =<span class="st"> </span><span class="kw">integrate</span>( <span class="dt">f=</span>pdf,
 <span class="dt">lower=</span><span class="op">-</span><span class="ot">Inf</span>, <span class="dt">upper=</span>q,
 <span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span>.<span class="dv">25</span>,
 <span class="dt">eta=</span>eta, <span class="dt">theta=</span>theta )
<span class="co"># return( list( value=result$value, abs.error=result$abs.error ) )</span>
 <span class="kw">return</span>( result<span class="op">$</span>value )
 } <span class="co">#end function </span></code></pre></div>
<p>consider the standard Cauchy</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>), <span class="dt">ncol=</span><span class="dv">1</span> )
<span class="kw">cbind</span>( x, <span class="kw">apply</span>(x, <span class="dt">MARGIN=</span><span class="dv">1</span>, <span class="dt">FUN=</span>cdfCauchy), <span class="kw">pcauchy</span>(x) )</code></pre></div>
<pre><code>##       [,1]       [,2]       [,3]
##  [1,]   -4 0.07797913 0.07797913
##  [2,]   -3 0.10241638 0.10241638
##  [3,]   -2 0.14758362 0.14758362
##  [4,]   -1 0.25000000 0.25000000
##  [5,]    0 0.50000000 0.50000000
##  [6,]    1 0.75000000 0.75000000
##  [7,]    2 0.85241638 0.85241638
##  [8,]    3 0.89758362 0.89758362
##  [9,]    4 0.92202087 0.92202087</code></pre>
<p>for <span class="math inline">\(\eta=2\quad and\quad\theta=1\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>( x, <span class="kw">apply</span>( x, <span class="dt">MARGIN=</span><span class="dv">1</span>, <span class="dt">FUN=</span>cdfCauchy, <span class="dt">eta=</span><span class="dv">2</span> ),
 <span class="kw">pcauchy</span>(x,<span class="dt">location=</span><span class="dv">2</span>) ) </code></pre></div>
<pre><code>##       [,1]       [,2]       [,3]
##  [1,]   -4 0.05256846 0.05256846
##  [2,]   -3 0.06283296 0.06283296
##  [3,]   -2 0.07797913 0.07797913
##  [4,]   -1 0.10241638 0.10241638
##  [5,]    0 0.14758362 0.14758362
##  [6,]    1 0.25000000 0.25000000
##  [7,]    2 0.50000000 0.50000000
##  [8,]    3 0.75000000 0.75000000
##  [9,]    4 0.85241638 0.85241638</code></pre>
<p>for <span class="math inline">\(\eta=0\quad and\quad\theta=2\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>( x, <span class="kw">apply</span>( x, <span class="dt">MARGIN=</span><span class="dv">1</span>, <span class="dt">FUN=</span>cdfCauchy, <span class="dt">theta=</span><span class="dv">2</span> ),
 <span class="kw">pcauchy</span>(x,<span class="dt">scale=</span><span class="dv">2</span>) ) </code></pre></div>
<pre><code>##       [,1]      [,2]      [,3]
##  [1,]   -4 0.1475836 0.1475836
##  [2,]   -3 0.1871670 0.1871670
##  [3,]   -2 0.2500000 0.2500000
##  [4,]   -1 0.3524164 0.3524164
##  [5,]    0 0.5000000 0.5000000
##  [6,]    1 0.6475836 0.6475836
##  [7,]    2 0.7500000 0.7500000
##  [8,]    3 0.8128330 0.8128330
##  [9,]    4 0.8524164 0.8524164</code></pre>
</div>
<div id="a-b-o-blood-type-problem" class="section level1">
<h1>A-B-O blood type problem</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(stats4)
nA&lt;-<span class="dv">28</span>;nB&lt;-<span class="dv">24</span>;nOO&lt;-<span class="dv">41</span>;nAB&lt;-<span class="dv">70</span>;
n&lt;-nA<span class="op">+</span>nB<span class="op">+</span>nOO<span class="op">+</span>nAB;
i=<span class="dv">0</span>;
p1&lt;-<span class="fl">0.3</span>;q1&lt;-<span class="fl">0.3</span>;
p0&lt;-<span class="dv">0</span>;q0&lt;-<span class="dv">0</span>;
<span class="kw">options</span>(<span class="dt">warn=</span><span class="op">-</span><span class="dv">1</span>)
<span class="cf">while</span>(<span class="op">!</span><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(p0,p1,<span class="dt">tolerance=</span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">7</span>)))<span class="op">||!</span><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(q0,q1,<span class="dt">tolerance=</span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">7</span>))))<span class="co">#EM?㷨</span>
{
  p0&lt;-p1;
  q0&lt;-q1;
mlogL&lt;-<span class="cf">function</span>(p,q){
  <span class="co"># minus log-likelihood</span>
<span class="kw">return</span>(<span class="op">-</span>(<span class="dv">2</span><span class="op">*</span>n<span class="op">*</span>p0<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(p)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>n<span class="op">*</span>q0<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(q)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)<span class="op">+</span>(nA<span class="op">-</span>n<span class="op">*</span>p0<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))<span class="op">+</span>(nB<span class="op">-</span>n<span class="op">*</span>q0<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(<span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)))<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)))
}
fit&lt;-<span class="kw">mle</span>(mlogL,<span class="dt">start=</span><span class="kw">list</span>(<span class="dt">p=</span><span class="fl">0.2</span>,<span class="dt">q=</span><span class="fl">0.3</span>))
p1&lt;-fit<span class="op">@</span>coef[<span class="dv">1</span>]
q1&lt;-fit<span class="op">@</span>coef[<span class="dv">2</span>]
i=i<span class="op">+</span><span class="dv">1</span>
}
<span class="kw">print</span>(<span class="kw">c</span>(i,p1,q1))</code></pre></div>
<pre><code>##                     p          q 
## 15.0000000  0.3685174  0.3493727</code></pre>
</div>
<div id="section-9" class="section level1">
<h1>9</h1>
</div>
<div id="question-9" class="section level1">
<h1>Question</h1>
<div id="exercise-3" class="section level3">
<h3>Exercise 3</h3>
<p>Use both for loops and lapply() to ???t linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
</div>
<div id="answer-23" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">attach</span>(mtcars)
formulas &lt;-<span class="st"> </span><span class="kw">list</span>( 
mpg <span class="op">~</span><span class="st"> </span>disp, 
mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp), 
mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt, 
mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt 
)
n&lt;-<span class="kw">length</span>(formulas)
<span class="co"># for loop</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  <span class="kw">print</span>(<span class="kw">lm</span>(formulas[[i]]))
}</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># lapply</span>
<span class="kw">lapply</span>(formulas,lm)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#we can see the values are equal</span>

<span class="kw">detach</span>(mtcars)</code></pre></div>
<div id="exercise-4" class="section level3">
<h3>Exercise 4</h3>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function?</p>
<p>bootstraps &lt;- lapply(1:10, function(i) { rows &lt;- sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
</div>
</div>
<div id="answer-24" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {
rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>) 
mtcars[rows, ] 
})
<span class="co"># for loop</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){
  <span class="kw">print</span>(<span class="kw">lm</span>(bootstraps[[i]]<span class="op">$</span>mpg<span class="op">~</span>bootstraps[[i]]<span class="op">$</span>disp))
}</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             28.05769              -0.03647  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.11683              -0.04082  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             26.57385              -0.02937  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             28.28313              -0.03724  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             31.60253              -0.04562  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##              28.7208               -0.0383  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             27.11226              -0.03166  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.34297              -0.04015  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             26.52186              -0.02975  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             28.06815              -0.03533</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># lapply</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){
  bootstraps[[i]]&lt;-<span class="kw">subset</span>(bootstraps[[i]],<span class="dt">select=</span><span class="kw">c</span>(mpg,disp))
}
<span class="kw">lapply</span>(bootstraps,lm)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.05769     -0.03647  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.11683     -0.04082  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.57385     -0.02937  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.28313     -0.03724  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.60253     -0.04562  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.7208      -0.0383  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.11226     -0.03166  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.34297     -0.04015  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.52186     -0.02975  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.06815     -0.03533</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#we can see the values are equal</span></code></pre></div>
<div id="exercise-5" class="section level3">
<h3>Exercise 5</h3>
<p>For each model in the previous two exercises,extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
</div>
<div id="answer-25" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Exercise 3</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">attach</span>(mtcars)
formulas &lt;-<span class="st"> </span><span class="kw">list</span>( 
mpg <span class="op">~</span><span class="st"> </span>disp, 
mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp), 
mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt, 
mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt 
)
n&lt;-<span class="kw">length</span>(formulas)
<span class="co"># for loop</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  <span class="kw">print</span>(<span class="kw">summary</span>(<span class="kw">lm</span>(formulas[[i]]))<span class="op">$</span>r.squared)
}</code></pre></div>
<pre><code>## [1] 0.7183433
## [1] 0.8596865
## [1] 0.7809306
## [1] 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># lapply</span>
<span class="kw">lapply</span>(formulas,<span class="cf">function</span>(x){
  <span class="kw">summary</span>(<span class="kw">lm</span>(x))<span class="op">$</span>r.squared
})</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#we can see the values are equal</span>
<span class="kw">detach</span>(mtcars)

<span class="co"># Exercise 4</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {
rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>) 
mtcars[rows, ] 
})
<span class="co"># for loop</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){
  <span class="kw">print</span>(<span class="kw">summary</span>(<span class="kw">lm</span>(bootstraps[[i]]<span class="op">$</span>mpg<span class="op">~</span>bootstraps[[i]]<span class="op">$</span>disp))<span class="op">$</span>r.squared)
}</code></pre></div>
<pre><code>## [1] 0.6606581
## [1] 0.8160798
## [1] 0.5806448
## [1] 0.7407087
## [1] 0.7589143
## [1] 0.6561107
## [1] 0.6021043
## [1] 0.6888394
## [1] 0.5989015
## [1] 0.723953</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># lapply</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){
  bootstraps[[i]]&lt;-<span class="kw">subset</span>(bootstraps[[i]],<span class="dt">select=</span><span class="kw">c</span>(mpg,disp))
}
<span class="kw">lapply</span>(bootstraps,<span class="cf">function</span>(x){
  <span class="kw">summary</span>(<span class="kw">lm</span>(x))<span class="op">$</span>r.squared
})</code></pre></div>
<pre><code>## [[1]]
## [1] 0.6606581
## 
## [[2]]
## [1] 0.8160798
## 
## [[3]]
## [1] 0.5806448
## 
## [[4]]
## [1] 0.7407087
## 
## [[5]]
## [1] 0.7589143
## 
## [[6]]
## [1] 0.6561107
## 
## [[7]]
## [1] 0.6021043
## 
## [[8]]
## [1] 0.6888394
## 
## [[9]]
## [1] 0.5989015
## 
## [[10]]
## [1] 0.723953</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#we can see the values are equal</span></code></pre></div>
<div id="exercise-3-1" class="section level3">
<h3>Exercise 3</h3>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE )</p>
<p>Extra challenge: get rid of the anonymous function by using [[ directly</p>
</div>
</div>
<div id="answer-26" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
trials &lt;-<span class="st"> </span><span class="kw">replicate</span>( <span class="dv">100</span>, <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)), <span class="dt">simplify =</span> <span class="ot">FALSE</span> )
<span class="kw">sapply</span>(trials,<span class="cf">function</span>(x){
  <span class="kw">return</span>(x<span class="op">$</span>p.value)
})</code></pre></div>
<pre><code>##   [1] 0.125949930 0.800930340 0.952855296 0.452959855 0.483083494
##   [6] 0.320611150 0.706780317 0.063119508 0.621092522 0.162276154
##  [11] 0.820427933 0.053095862 0.914712292 0.792200487 0.390189150
##  [16] 0.538640844 0.143988430 0.788393427 0.672267752 0.216269737
##  [21] 0.534646674 0.809214595 0.960266963 0.569466705 0.632178255
##  [26] 0.582700745 0.254983356 0.282179271 0.005098396 0.162075913
##  [31] 0.877783340 0.654074362 0.169752059 0.754440969 0.764179721
##  [36] 0.026793925 0.114713268 0.028496672 0.598991648 0.885239097
##  [41] 0.719211331 0.409696973 0.847167535 0.764438221 0.418863595
##  [46] 0.519132187 0.463910875 0.286785195 0.875030871 0.241068098
##  [51] 0.838739962 0.348638336 0.622633185 0.232606824 0.398974335
##  [56] 0.970218660 0.860375193 0.909101881 0.851096482 0.523397015
##  [61] 0.746860279 0.764894312 0.025411594 0.019036587 0.397989350
##  [66] 0.714919878 0.631471636 0.110724341 0.927143289 0.041990454
##  [71] 0.208117904 0.607178718 0.906974079 0.554576397 0.194404278
##  [76] 0.771678543 0.396686801 0.803958799 0.768941702 0.994186553
##  [81] 0.194123673 0.316046848 0.415575715 0.619270683 0.295629509
##  [86] 0.942948679 0.607585865 0.718018866 0.761453123 0.120281420
##  [91] 0.577128336 0.019315507 0.483007741 0.108496205 0.469918314
##  [96] 0.011282410 0.231024499 0.955230239 0.964944823 0.281065452</code></pre>
<div id="exercise-6" class="section level3">
<h3>Exercise 6</h3>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
</div>
<div id="answer-27" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(foreach)
x&lt;-<span class="kw">foreach</span>(<span class="dt">a=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">b=</span><span class="kw">rep</span>(<span class="dv">10</span>,<span class="dv">3</span>),<span class="dt">.combine =</span> <span class="st">&quot;rbind&quot;</span>)<span class="op">%do%</span>{
  x1&lt;-(a<span class="op">+</span>b)
  x2&lt;-(a<span class="op">*</span>b)
  <span class="kw">c</span>(x1,x2)
}
x</code></pre></div>
<pre><code>##          [,1] [,2]
## result.1   11   10
## result.2   12   20
## result.3   13   30</code></pre>
</div>
<div id="section-10" class="section level1">
<h1>10</h1>
</div>
<div id="question-10" class="section level1">
<h1>Question</h1>
<div id="exercise-4-1" class="section level3">
<h3>exercise 4</h3>
</div>
<div id="page-365-advanced-r" class="section level3">
<h3>page 365, Advanced R</h3>
<p>Make a faster version of chisq.test() that only computes the chi-square test statistic when the input is two numeric vectors with no missing values. You can try simplifying chisq.test() or by coding from the mathematical de???nition (<a href="http://en" class="uri">http://en</a>. wikipedia.org/wiki/Pearson%27s_chi-squared_test).</p>
</div>
</div>
<div id="answer-28" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(microbenchmark)
a=<span class="kw">c</span>(<span class="dv">12</span>,<span class="dv">24</span>)
b=<span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">10</span>)
e=<span class="kw">c</span>(<span class="dv">11</span>,<span class="dv">30</span>)
f=<span class="kw">c</span>(<span class="dv">40</span>,<span class="dv">34</span>)
<span class="co"># chisq.test</span>
tableR&lt;-<span class="kw">cbind</span>(a,b)
chisq1=<span class="kw">chisq.test</span>(tableR)<span class="op">$</span>statistic
<span class="co"># a faster version of chisq.test</span>
chisq.test2&lt;-<span class="cf">function</span>(x1,x2){
  x&lt;-<span class="kw">cbind</span>(x1,x2)
  sr &lt;-<span class="st"> </span><span class="kw">rowSums</span>(x)
  sc &lt;-<span class="st"> </span><span class="kw">colSums</span>(x)
  n&lt;-<span class="kw">sum</span>(sr)
  E &lt;-<span class="st"> </span><span class="kw">outer</span>(sr, sc, <span class="st">&quot;*&quot;</span>)<span class="op">/</span>n
  YATES &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="fl">0.5</span>, <span class="kw">abs</span>(x <span class="op">-</span><span class="st"> </span>E))
  STATISTIC &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">abs</span>(x <span class="op">-</span><span class="st"> </span>E) <span class="op">-</span><span class="st"> </span>YATES)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>E)
  <span class="kw">return</span>(STATISTIC)
}
chisq2=<span class="kw">chisq.test2</span>(a,b)
<span class="kw">round</span>(<span class="kw">c</span>(chisq1,chisq2),<span class="dv">5</span>)</code></pre></div>
<pre><code>## X-squared           
##   8.85015   8.85015</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chisq1=<span class="kw">chisq.test</span>(<span class="kw">cbind</span>(e,f))<span class="op">$</span>statistic
chisq2=<span class="kw">chisq.test2</span>(e,f)
<span class="kw">round</span>(<span class="kw">c</span>(chisq1,chisq2),<span class="dv">5</span>)</code></pre></div>
<pre><code>## X-squared           
##   6.85835   6.85835</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># chisq2 is faster</span>
ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">chisq1=</span><span class="kw">chisq.test</span>(tableR)<span class="op">$</span>statistic,<span class="dt">chisq2=</span><span class="kw">chisq.test2</span>(a,b)) 
<span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</code></pre></div>
<pre><code>##     expr     lq median      uq
## 1 chisq1 64.771 65.799 67.3415
## 2 chisq2 21.077 23.646 24.1610</code></pre>
<div id="exercise-5-1" class="section level3">
<h3>exercise 5</h3>
</div>
<div id="page-365-advanced-r-1" class="section level3">
<h3>page 365, Advanced R</h3>
<p>Can you make a faster version of table() for the case of an input of two integer vectors with no missing values? Can you use it to speed up your chi-square test?</p>
</div>
</div>
<div id="answer-29" class="section level1">
<h1>Answer</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(microbenchmark)
a=<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)
b=<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)
<span class="co"># a faster version of table()</span>
table2 &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {
  x_val &lt;-<span class="st"> </span><span class="kw">unique</span>(x)
  y_val &lt;-<span class="st"> </span><span class="kw">unique</span>(y)
  mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(0L, <span class="kw">length</span>(x_val), <span class="kw">length</span>(y_val))
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {
    mat[<span class="kw">which</span>(x_val <span class="op">==</span><span class="st"> </span>x[[i]]), <span class="kw">which</span>(y_val <span class="op">==</span><span class="st"> </span>y[[i]])]&lt;-mat[<span class="kw">which</span>(x_val <span class="op">==</span><span class="st"> </span>x[[i]]),<span class="kw">which</span>(y_val <span class="op">==</span><span class="st"> </span>y[[i]])] <span class="op">+</span><span class="st"> </span>1L
  }
  dimnames &lt;-<span class="st"> </span><span class="kw">list</span>(x_val, y_val)
  <span class="kw">names</span>(dimnames) &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">as.list</span>(<span class="kw">match.call</span>())[<span class="op">-</span><span class="dv">1</span>])  <span class="co"># R has names for dimnames... :/</span>
  tab &lt;-<span class="st"> </span><span class="kw">array</span>(mat, <span class="dt">dim =</span> <span class="kw">dim</span>(mat), <span class="dt">dimnames =</span> dimnames)
  <span class="kw">class</span>(tab) &lt;-<span class="st"> &quot;table&quot;</span>
  tab
}
<span class="kw">table</span>(a,b)</code></pre></div>
<pre><code>##    b
## a   0 1
##   0 2 1
##   1 1 3
##   2 0 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table2</span>(a,b)</code></pre></div>
<pre><code>##    b
## a   0 1
##   0 2 1
##   1 1 3
##   2 0 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(<span class="kw">table</span>(a,b),<span class="kw">table2</span>(a,b))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>)
f=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>)
<span class="kw">table</span>(d,f)</code></pre></div>
<pre><code>##    f
## d   1 2 3 5
##   1 1 0 1 0
##   2 0 2 0 1
##   3 0 1 1 0
##   5 0 1 0 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table2</span>(d,f)</code></pre></div>
<pre><code>##    f
## d   1 2 3 5
##   1 1 0 1 0
##   2 0 2 0 1
##   3 0 1 1 0
##   5 0 1 0 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(<span class="kw">table</span>(d,f),<span class="kw">table2</span>(d,f))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># table2 is faster</span>
ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">table=</span><span class="kw">table</span>(d,f),<span class="dt">table2=</span><span class="kw">table2</span>(d,f)) 
<span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</code></pre></div>
<pre><code>##     expr       lq  median      uq
## 1  table 145.4770 149.590 151.646
## 2 table2  50.1205  53.462  55.518</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
